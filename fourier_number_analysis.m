clear all

%fourier number analysis

%thermal diffusivities k/pc
%ice
k_ice = [-135	4.1996437
-133	4.161086228
-131	4.122804372
-129	4.084798132
-127	4.047067508
-125	4.0096125
-123	3.972433108
-121	3.935529332
-119	3.898901172
-117	3.862548628
-115	3.8264717
-113	3.790670388
-111	3.755144692
-109	3.719894612
-107	3.684920148
-105	3.6502213
-103	3.615798068
-101	3.581650452
-99	3.547778452
-97	3.514182068
-95	3.4808613
-93	3.447816148
-91	3.415046612
-89	3.382552692
-87	3.350334388
-85	3.3183917
-83	3.286724628
-81	3.255333172
-79	3.224217332
-77	3.193377108
-75	3.1628125
-73	3.132523508
-71	3.102510132
-69	3.072772372
-67	3.043310228
-65	3.0141237
-63	2.985212788
-61	2.956577492
-59	2.928217812
-57	2.900133748
-55	2.8723253
-53	2.844792468
-51	2.817535252
-49	2.790553652
-47	2.763847668
-45	2.7374173
-43	2.711262548
-41	2.685383412
-39	2.659779892
-37	2.634451988
-35	2.6093997
-33	2.584623028
-31	2.560121972
-29	2.535896532
-27	2.511946708
-25	2.4882725
-23	2.464873908
-21	2.441750932];

k_icep = polyfit(k_ice(:,1),k_ice(:,2),4)
figure(1)
plot(k_ice(:,1),polyval(k_icep,k_ice(:,1)),'-k')
hold on
plot(k_ice(:,1),k_ice(:,2),'or')

p_ice = [-140	932.02046
-132.631578947368	931.229909473684
-125.263157894737	930.439358947369
-117.894736842105	929.648808421053
-110.526315789474	928.858257894737
-103.157894736842	928.067707368421
-95.7894736842105	927.277156842105
-88.421052631579	926.486606315789
-81.0526315789474	925.696055789474
-73.6842105263158	924.905505263158
-66.3157894736842	924.114954736842
-58.9473684210526	923.324404210526
-51.5789473684211	922.533853684211
-44.2105263157895	921.743303157895
-36.8421052631579	920.952752631579
-29.4736842105263	920.162202105263
-22.1052631578947	919.371651578947
-14.7368421052632	918.581101052632];

p_icep = polyfit(p_ice(:,1),p_ice(:,2),1)
figure(2)
plot(p_ice(:,1),polyval(p_icep,p_ice(:,1)),'-k')
hold on
plot(p_ice(:,1),p_ice(:,2),'or')

c_ice = [-144.473684210526	1070.54631578947
-134.842105263158	1136.90789473684
-125.210526315789	1203.26947368421
-115.578947368421	1269.63105263158
-105.947368421053	1335.99263157895
-96.3157894736842	1402.35421052632
-86.6842105263158	1468.71578947368
-77.0526315789474	1535.07736842105
-67.421052631579	1601.43894736842
-57.7894736842105	1667.80052631579
-48.1578947368421	1734.16210526316
-38.5263157894737	1800.52368421053
-28.8947368421053	1866.88526315789
-19.2631578947369	1933.24684210526];

c_icep = polyfit(c_ice(:,1),c_ice(:,2),1)
figure(3)
plot(c_ice(:,1),polyval(c_icep,c_ice(:,1)),'-k')
hold on
plot(c_ice(:,1),c_ice(:,2),'or')

k_cpa = [-150	0.2947
-54	0.3185
20	0.3707];

k_cpap = polyfit(k_cpa(:,1),k_cpa(:,2),2)
figure(4)
plot(k_cpa(:,1),polyval(k_cpap,k_cpa(:,1)),'-k')
hold on
plot(k_cpa(:,1),k_cpa(:,2),'or')

p_cpa = [-165	1125
20	1050];

p_cpap = polyfit(p_cpa(:,1),p_cpa(:,2),1)
figure(5)
plot(p_cpa(:,1),polyval(p_cpap,p_cpa(:,1)),'-k')
hold on
plot(p_cpa(:,1),p_cpa(:,2),'or')


c_cpa = [-136.95	1361.637579
-120.85	1635.090689
-106.25	1853.919388
-90.75	2057.188406
-73.65	2249.201486
-64.25	2341.897455
-55.95	2417.378459
-43.95	2516.364512
-35.35	2580.589576
-30	2591.049982
-25	2622.267719
-20	2666.347092];

c_cpap = polyfit(c_cpa(:,1),c_cpa(:,2),3)
figure(6)
plot(c_cpa(:,1),polyval(c_cpap,c_cpa(:,1)),'-k')
hold on
plot(c_cpa(:,1),c_cpa(:,2),'or')

T = linspace(-135,-22,100);

a_cpa = (polyval(k_cpap,T))./((polyval(p_cpap,T)).*(polyval(c_cpap,T)));
a_cpa = mean(a_cpa)

a_ice = (polyval(k_icep,T))./((polyval(p_icep,T)).*(polyval(c_icep,T)));
a_ice = mean(a_ice)

%compute Fo numbers for the four cases of kidney preservation
%for T = 90% of range, (T = -124.1)
t_A_90 = 98.13*60;
t_rA_90 = 15*60;
t_B_90 = 8.96*60;
t_rB_90 = 4*60;

%for T = 95% of range, (T = -129.7)
t_A_95 = 116.3*60;
t_rA_95 = 17.5*60;
t_B_95 = 10.4*60;
t_rB_95 = 5.4*60;

LA = 4.45e-2;%m
V = 0.127*pi*(LA)^2;
A = pi*2*(LA)*0.127;
LA = V/A;%characteristic length



LrA = 1.6e-2;%cm
V = 0.0457*pi*(LrA)^2;
A = pi*2*(LrA)*0.0457;
LrA = V/A;%characteristic length


%for T = 90%
F_A_90 = (a_cpa*t_A_90)/(LA)^2
F_rA_90 = (a_cpa*t_rA_90)/(LrA)^2
F_B_90 = (a_ice*t_B_90)/(LA)^2
F_rB_90 = (a_ice*t_rB_90)/(LrA)^2

%for T = 95%
F_A_95 = (a_cpa*t_A_95)/(LA)^2
F_rA_95 = (a_cpa*t_rA_95)/(LrA)^2
F_B_95 = (a_ice*t_B_95)/(LA)^2
F_rB_95 = (a_ice*t_rB_95)/(LrA)^2
